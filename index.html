<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Frank Aragona">
<meta name="dcterms.date" content="2024-11-22">
<meta name="description" content="Setting up public GitHub use for the NW-PaGe organization">

<title>Public GitHub Overview</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-d81579136e7cdf963dca2dc50d024de2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/quarto-contrib/intersection-observer-polyfill-1.0.0/intersection-observer.js"></script>
<script src="index_files/libs/quarto-contrib/scrollama-3.2.0/scrollama.min.js"></script>
<script src="index_files/libs/quarto-contrib/closeread-0.1.0/closeread.js"></script>
<link href="index_files/libs/quarto-contrib/bootstrap-icons-1.11.1/all.css" rel="stylesheet">
<meta cr-debug-mode="false">
<meta cr-remove-header-space="false">


<link rel="stylesheet" href="_extensions/qmd-lab/closeread/closeread.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">Public GitHub Overview</h1>
                  <div>
        <div class="description">
          Setting up public GitHub use for the NW-PaGe organization
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta column-page">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Frank Aragona <a href="mailto:frank.aragona@doh.wa.gov" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 22, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">December 9, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content quarto-banner-title-block column-page" id="quarto-document-content">
      <!-- user-provided yaml closeread style options -->
      <style>
        :root {
          --cr-section-background-color: #062a4a;
--cr-narrative-text-color-sidebar: #fdfdfd;
        }
      </style>
    





<section id="overview" class="level1 splash-page">
<h1>Overview</h1>
<ul>
<li>NW-PaGe GitHub org details <i class="bi-bezier2 " style="font-size: 1.5em;" role="img" aria-hidden="true"></i></li>
<li>Washington DOH GitHub use statistics over time <i class="bi-graph-up-arrow " style="font-size: 1.5em;" role="img" aria-hidden="true"></i></li>
<li>Security <i class="bi-shield-lock " style="font-size: 1.5em;" role="img" aria-hidden="true"></i></li>
<li>GitHub Pages + Quarto <i class="bi-file-earmark-binary " style="font-size: 1.5em;" role="img" aria-hidden="true"></i></li>
<li>Examples <i class="bi-rocket-takeoff " style="font-size: 1.5em;" role="img" aria-hidden="true"></i></li>
</ul>
</section>
<section id="nw-page-github-org-link" class="level2 splash-page">
<h2 class="anchored" data-anchor-id="nw-page-github-org-link">NW-PaGe GitHub Org (<a href="https://github.com/NW-PaGe">link</a>)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<section id="goals" class="level3">
<h3 class="anchored" data-anchor-id="goals">Goals</h3>
<ul>
<li>Transparency</li>
<li>Reproducibility</li>
<li>Education</li>
<li>Collaboration</li>
</ul>
</section>
</div><div class="column" style="width:50%;">
<section id="my-goals" class="level3">
<h3 class="anchored" data-anchor-id="my-goals">My Goals</h3>
<ul>
<li>Write the SOPs</li>
<li>Prevent data leaks</li>
<li>Explore publishing tools</li>
<li>Get the ball rolling</li>
</ul>
</section>
</div>
</div>
<p><img src="images/dc.gif" class="myframe2 img-fluid" style="display: block; margin: 20px auto;"></p>
</section>
<p><br></p>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-timeline1">
<div class="narrative">
<p>Let’s start with a timeline of GitHub use at WA DOH.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-timeline2">
<div class="narrative">
<p>Our Epi GitHub Org was created in 2020. In 2021 The Data Science and Support Unit began using Git and GitHub for version control when developing the sequencing metadata integration pipeline.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-timeline3">
<div class="narrative">
<p>It took a while.. but eventually more epidemiologists started to ask for and receive GitHub licenses. In 2022 we received a batch of licenses, ~ &gt; 150 DOH users set up GitHub accounts, we set up collaborative repos for MPV response, and started discussions on public GitHub use.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-timeline4">
<div class="narrative">
<p>In Feb.&nbsp;2024 we created the SOPs for public GitHub use in the NW-PaGe org and published the first repo in March 2024.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-timeline5">
<div class="narrative">
<p>As of now (Dec.&nbsp;2024), we have <strong>436</strong> repos in the DOH-EPI-Coders org and <strong>22</strong> repos in the NW-PaGe org</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-timeline1" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-timeline2" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-timeline3" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-timeline4" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="cr-timeline5" class="sticky">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<section id="policies-overview" class="level2">
<h2 class="anchored" data-anchor-id="policies-overview">Policies Overview</h2>
<p>Here are the <a href="https://nw-page.github.io/standards/">docs</a></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Checklist</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Security</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">For Admins</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Collaboration Guide</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Licensing</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">Tutorials</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Here’s a <a href="https://nw-page.github.io/standards/gh/quickstart.html">checklist for getting started</a></p>
<ul>
<li>For those looking to make a new repo</li>
<li>Security items to review</li>
<li>Create security guardrails</li>
<li>Secret scanning</li>
<li>Licensing</li>
<li>Branch protections</li>
<li>Documentations</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li>cannot push credentials or sensitive data (<a href="https://nw-page.github.io/standards/gh/security.html#tbl-prohibit">here’s a list</a>)</li>
<li><a href="https://nw-page.github.io/standards/gh/security.html#sec-creds">.gitignore</a></li>
<li><a href="https://nw-page.github.io/standards/gh/security.html#sec-hooks">hooks</a></li>
<li><a href="https://nw-page.github.io/standards/gh/security.html#sec-scan">secret scanning</a></li>
<li>convert private repo to <a href="https://nw-page.github.io/standards/gh/security.html#sec-public">public</a></li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><a href="https://nw-page.github.io/standards/gh/policies.html">Policies at the Org level</a></p>
<ul>
<li>Code of conduct</li>
<li>Contributing form</li>
<li>Templates (Issues, PRs, Requests, Discussions)</li>
<li>GitHub apps for code sign off</li>
</ul>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Here’s a <a href="https://nw-page.github.io/standards/gh/contribute.html">collab guide</a></p>
<ul>
<li>Git/GitHub basics</li>
<li>How to contribute to a repo</li>
<li>Git/GitHub workflows</li>
</ul>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Use an MIT license for everything. Here’s more <a href="https://nw-page.github.io/standards/gh/lic.html">info</a></p>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<ul>
<li><a href="https://nw-page.github.io/standards/gh/release.html">Automated release cycles in your repo</a></li>
<li><a href="https://nw-page.github.io/standards/gh/renv.html">Virtual environments in R/Python</a></li>
<li><a href="https://nw-page.github.io/standards/gh/templates.html">Templates</a></li>
<li><a href="https://nw-page.github.io/standards/gh/how_to.html">Quarto for documentation</a></li>
<li><a href="https://nw-page.github.io/standards/gh/newrepo.html">Creating a new repo</a></li>
</ul>
</div>
</div>
</div>
</section>
<section id="security---pre-commit-hooks" class="level1">
<h1>Security - Pre-Commit Hooks</h1>
<section id="create-secret-key" class="level2">
<h2 class="anchored" data-anchor-id="create-secret-key">Create Secret Key</h2>
<p>This file contains regular expressions of credentials that are <em>prohibited</em> from being in a remote GitHub repo.</p>
<p><img src="images/test_key.gif" class="myframe img-fluid"></p>
</section>
<section id="example-script" class="level2">
<h2 class="anchored" data-anchor-id="example-script">Example Script</h2>
<p>The script below has hardcoded prohibited patterns.</p>
<p><img src="images/test_key_script.gif" class="myframe img-fluid"></p>
</section>
<section id="pattern-rejection" class="level2">
<h2 class="anchored" data-anchor-id="pattern-rejection">Pattern Rejection</h2>
<p><a href="https://github.com/awslabs/git-secrets">AWS Git Secrets</a> rejects the commit if it detects the patterns found in the secret key file.</p>
<p><img src="images/test_key_flag.gif" class="myframe img-fluid"></p>
</section>
<section id="output" class="level2">
<h2 class="anchored" data-anchor-id="output">Output</h2>
<p>The first three lines show the regex patterns that got flagged, along with a warning message. The last chunk gives you instructions on how to handle false positives.</p>
<div class="codewindow">
<div class="header">
<svg viewbox="0 0 420 100" style="width:55px">
<circle fill="#ff5f57" cx="50" cy="50" r="50"></circle><circle fill="#febc2e" cx="210" cy="50" r="50"></circle><circle fill="#28c840" cx="370" cy="50" r="50"></circle>
</svg>
<div class="file">
<p>output</p>
</div>
</div>
<div class="textarea">
<div class="sourceCode">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">test.R:3:user</span> <span class="op">&lt;</span>- secret_username</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="ex">test.R:4:password</span> <span class="op">&lt;</span>- secret_password</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="ex">test.R:6:connection</span> <span class="op">&lt;</span>- ODBC_CONNECTION1</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="ex">[ERROR]</span> Matched one or more prohibited patterns</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="ex">Possible</span> mitigations:</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="ex">-</span> Mark false positives as allowed using: git config <span class="at">--add</span> secrets.allowed ...</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="ex">-</span> Mark false positives as allowed by adding regular expressions to .gitallowed at repository<span class="st">'s root directory</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="st">- List your configured patterns: git config --get-all secrets.patterns</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="st">- List your configured allowed patterns: git config --get-all secrets.allowed</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="st">- List your configured allowed patterns in .gitallowed at repository'</span>s root directory</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="ex">-</span> Use <span class="at">--no-verify</span> if this is a one-time false positive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="github-pages-and-quarto" class="level1">
<h1>GitHub Pages and Quarto</h1>
<p>We can use GitHub Pages to host htmls, and Quarto to develop websites, books, articles, presentations, and reports.</p>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-report">
<div class="narrative">
<p>Here’s an example parameterized and automated report.</p>
</div>
</div>
<div class="trigger new-trigger" data-scale-by="3.1" data-pan-to="-40%,60%" data-focus-on="cr-report">
<div class="narrative">
<p>We can bake our code into the report and produce plots and statistics so that we don’t need to copy and paste screen shots of the plots or manually update numbers everytime we generate the report.</p>
</div>
</div>
<div class="trigger new-trigger" data-scale-by="3.1" data-pan-to="60%,-90%" data-focus-on="cr-report">
<div class="narrative">
<p>And likewise with text. We don’t need to ‘hardcode’ any text into the document. Notice the statistics written in the text - all of them are ‘written’ using code and can be automatically updated whenever there are changes.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-report" class="sticky">
<p><img src="images/typst-report.png" class="img-fluid" width="500"></p>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger">
<div class="narrative">
<p>Here’s how you can automate your reports <i class="bi-cloud-snow-fill " style="font-size: 2em;" role="img" aria-hidden="true"></i></p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-yaml">
<div class="narrative">
<p>Here is a quarto (.qmd) file that processes data and outputs our report.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="1-11" data-focus-on="cr-yaml">
<div class="narrative">
<p>In the yaml front matter we can define metadata. Here I’m specifying that I want multiple formats to be produced from this file along with a set of parameters.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="15" data-focus-on="cr-yaml">
<div class="narrative">
<p>You can write markdown text, link to Zotero, and make cross references.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="17-21" data-focus-on="cr-yaml">
<div class="narrative">
<p>And you can embed figures/code from external scripts.</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-yaml" class="sticky">
<div class="codewindow medframe">
<div class="header">
<svg viewbox="0 0 420 100" style="width:55px">
<circle fill="#ff5f57" cx="50" cy="50" r="50"></circle><circle fill="#febc2e" cx="210" cy="50" r="50"></circle><circle fill="#28c840" cx="370" cy="50" r="50"></circle>
</svg>
<div class="file">
<p>report.qmd</p>
</div>
</div>
<div class="textarea">
<div class="sourceCode">
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Epi Report</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">      html: default</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">      pdf: default</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">      docx: default</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">      typst: default</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="an">param:</span><span class="co"> </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">      state: "WA"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">      year: "2024"</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>Text here, @citation here @cross-section-link here</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>Here's a table:</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>{{&lt; embed notebooks/nwcoe.qmd#tab-countprop &gt;}}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>Here's a plot:</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>{{&lt; embed notebooks/nwcoe.ipynb#fig-trendline &gt;}}</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger new-trigger" data-focus-on="cr-yaml2">
<div class="narrative">
<p>We can bake code into the report and use the outputs in the text.</p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="5-9" data-focus-on="cr-yaml2">
<div class="narrative">
<p>This code chunk pulls data from a model and assigns it to a variable named <code>wa_prop</code></p>
</div>
</div>
<div class="trigger new-trigger" data-highlight="15" data-focus-on="cr-yaml2">
<div class="narrative">
<p>And we can use the output <code>wa_prop</code> in the text like this:</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-report-sum">
<div class="narrative">
<p>And now our code can automatically update the text in the report:</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-yaml2" class="sticky">
<div class="codewindow medframe">
<div class="header">
<svg viewbox="0 0 420 100" style="width:55px">
<circle fill="#ff5f57" cx="50" cy="50" r="50"></circle><circle fill="#febc2e" cx="210" cy="50" r="50"></circle><circle fill="#28c840" cx="370" cy="50" r="50"></circle>
</svg>
<div class="file">
<p>report.qmd</p>
</div>
</div>
<div class="textarea">
<div class="sourceCode">
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a model </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="in">model &lt;- multinom(cbind(Alpha, Delta, Omicron) ~ Date,data = variant_data_wide)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="in">wa_prop &lt;- predicted_data %&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(desc(Date)) %&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(1) %&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="in">  pull(Alpha) %&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="in">  scales::percent(., accuracy = 0.01)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Site Summaries</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Washington State Department of Health - Alpha variant proportion is <span class="in">`{r} wa_prop`</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Georgia Department of Public Health probablity of detection: <span class="in">`{r} ga_prop`</span> and the consensus genomes are uploaded to public repositories like GISAID and GenBank.</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Massachusetts Department of Health prop - <span class="in">`{r} ne_prop`</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Virginia Deparment of Health - <span class="in">`{r} va_prop`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div id="cr-report-sum" class="sticky">
<p><img src="images/site_sum.png" class="myframe2 img-fluid"></p>
</div>
</div>
</div>
</div>
<div class="cr-section cr-column-screen sidebar-left">
<div class="narrative-col">
<div class="trigger">
<div class="narrative">
<p>Here’s how parameterized reports work <i class="bi-rocket-takeoff-fill " style="font-size: 2em;" role="img" aria-hidden="true"></i></p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-template1">
<div class="narrative">
<p>Start with our .qmd file.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-template2">
<div class="narrative">
<p>When rendering, we can set the parameter we want.</p>
</div>
</div>
<div class="trigger new-trigger" data-focus-on="cr-template3">
<div class="narrative">
<p>Quarto will generate a separate output file for each parameter set, with the data filtered according to the specified parameter(s).</p>
</div>
</div>
</div>
<div class="sticky-col">
<div class="sticky-col-stack">
<div id="cr-template1" class="sticky">
<p><img src="images/template1.svg" width="1100" height="900"></p>
</div>
<div id="cr-template2" class="sticky">
<p><img src="images/template2.svg" width="1100" height="900"></p>
</div>
<div id="cr-template3" class="sticky">
<p><img src="images/template3.svg" width="1100" height="900"></p>
</div>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="but-who-cares" class="level1 splash-page">
<h1>but who cares?</h1>
<p>I do!</p>
<p>We can use Quarto and GitHub to showcase our work and run code automatically. A GitHub Action can run code conditionally or on a schedule, and GitHub Pages can host the html output of our reports.</p>
<p><img src="images/gh-action.png" class="myframe img-fluid"></p>
<p><img src="images/gh-page.png" class="myframe img-fluid"></p>
</section>
<section id="examples" class="level1">
<h1>examples</h1>
<section id="covid-seq-elr" class="level2">
<h2 class="anchored" data-anchor-id="covid-seq-elr"><a href="https://github.com/NW-PaGe/covid_seq_elr">COVID Seq ELR</a></h2>
<p><strong>Author: Philip Crain</strong></p>
<p>Summarize and share COVID-19 Sequencing Metadata ELR data flow at the Washington State Department of Health.</p>
<table>
<tbody><tr>
<td valign="top">
<p>This repo provides a high-level description of the Sars-CoV-2 sequencing metadata ELR ingestion process at DOH, from lab submissions to ingestion into the Washington Disease Reporting System where it is linked with epi data. See the <a href="https://nw-page.github.io/covid_seq_elr">GitHub Page</a> for more information</p>
</td>
<td valign="top">
<a href="https://nw-page.github.io/covid_seq_elr"><img src="images/covid-seq-elr.png" class="img-fluid" style="border: 5px solid black; padding: 5px;" width="1000"></a>
</td>
</tr>
</tbody></table>
</section>
<section id="case-study-vibrio" class="level2">
<h2 class="anchored" data-anchor-id="case-study-vibrio"><a href="https://github.com/NW-PaGe/Case-Study-Vibrio">Case Study Vibrio</a></h2>
<p><strong>Author: Marcela Torres</strong></p>
<p>Currently only internal users can see this repo and GitHub Page.</p>
<table>
<tbody><tr>
<td valign="top">
<p>This case study is intended for epidemiologists, bioinformaticians, and other public health professionals who are interested in using sequencing data as a way to better understand transmission and links between cases. We provide a couple of options to execute some of the tasks based on different levels of expertise. See <a href="https://ubiquitous-disco-j59rm5o.pages.github.io/">GitHub Page</a> for more details.</p>
</td>
<td valign="top">
<a href="https://ubiquitous-disco-j59rm5o.pages.github.io/"><img src="images/vibrio.png" class="img-fluid" style="border: 5px solid black; padding: 5px;" width="1450"></a>
</td>
</tr>
</tbody></table>
</section>
<section id="mpox-surveillance-for-wa-doh" class="level2">
<h2 class="anchored" data-anchor-id="mpox-surveillance-for-wa-doh"><a href="https://github.com/NW-PaGe/mpox-surveillance">MPOX Surveillance for WA DOH</a></h2>
<p><strong>Author: Pauline Trinh</strong></p>
<p>Currently only internal users can see this repo and GitHub Page.</p>
<table>
<tbody><tr>
<td valign="top">
<p>This repo contains scripts and information on how MPOX sequencing data is retrieved from NCBI and analyzed in Nextclade to look for mutations associated with tecovirimat resistance (asparagine 267 deletion N267del and alanine-184-to-threonine substitution A184T) and generate a report of those findings.</p>
<p>Currently the report and scripts in this repository are automated to run biweekly on Mondays at 7am Pacific Time using GitHub Actions. For manual running of the scripts in this repository please see instructions below.</p>
</td>
<td valign="top">
<a href="https://github.com/NW-PaGe/mpox-surveillance"><img src="images/mpox.png" class="img-fluid" style="border: 5px solid black; padding: 5px;" width="1190"></a>
</td>
</tr>
</tbody></table>
</section>
<section id="covid-19-lineage-classifications" class="level2">
<h2 class="anchored" data-anchor-id="covid-19-lineage-classifications"><a href="https://github.com/NW-PaGe/lineage_classifications">COVID-19 Lineage Classifications</a></h2>
<p><strong>Authors: Lauren Frisbie, Alena Schroeder, Frank Aragona</strong></p>
<p>Create a public lineage classifications dataset. The dataset is maintained by the WA DOH Molecular Epidemiology Program in order to group the lineages for the Sequencing &amp; Variants Report.</p>
<table>
<tbody><tr>
<td valign="top">
<p>This repo contains scripts that will pull SARS-COV-2 lineages of interest from CDC’s repo, transform the data for Washington State DOH reporting purposes, and then output the resulting lineage classifications dataset. The dataset will be produced biweekly and can be found in the data folder. See instructions below on how to pull the dataset in R or Python.</p>
<p>For more information on how the scripts work, plots, and guides on how to pull data from the repo, please open the <a href="https://nw-page.github.io/lineage_classifications/">github page</a>.</p>
</td>
<td valign="top">
<a href="https://nw-page.github.io/lineage_classifications/"><img src="images/lineages.png" class="img-fluid" style="border: 5px solid black; padding: 5px;" width="1500"></a>
</td>
</tr>
</tbody></table>
</section>
<section id="seq-integration-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="seq-integration-pipeline"><a href="https://github.com/NW-PaGe/sequencing_integration_pipeline1.0">Seq Integration Pipeline</a></h2>
<p><strong>Author: DIQA, MEP, DSSU, evvveryone</strong></p>
<p>Documentation on the first version of the data integration pipeline for sequencing metadata at WA DOH - used during the height of the COVID-19 pandemic.</p>
<table>
<tbody><tr>
<td valign="top">
<p>For a more detailed look at the pipeline, please read the manuscript in our <a href="https://nw-page.github.io/sequencing_integration_pipeline1.0/">github page</a>. The document comes in multiple formats (HTML, PDF and MS Word) and all the main code is documented under the Notebooks tab in the site. There are links to dev containers if you wish to explore the code, although there are no test data sets available at this time. In the future we will push our updated pipelines and test data so that you can explore the code.</p>
</td>
<td valign="top">
<a href="https://github.com/NW-PaGe/sequencing_integration_pipeline1.0"><img src="images/seq_1.0.png" class="img-fluid" style="border: 5px solid black; padding: 5px;" width="1750"></a>
</td>
</tr>
</tbody></table>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>